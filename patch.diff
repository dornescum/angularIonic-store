From f2e4c4ebd1c234d1e3f213c38a6f47fd14b4645c Mon Sep 17 00:00:00 2001
From: Mihai Dornescu <dornescu@gmail.com>
Date: Mon, 22 Aug 2022 21:48:49 +0300
Subject: [PATCH] error cards page routing module

---
 src/app/app-routing.module.ts                 |  7 ++++
 src/app/app.module.ts                         |  5 +--
 .../components/product/product.component.html | 21 ++++++++---
 .../components/product/product.component.ts   | 25 ++++++-------
 src/app/pages/cards/cards-routing.module.ts   |  3 +-
 src/app/pages/cards/cards.module.ts           |  6 ++--
 src/app/pages/cards/cards.page.html           | 12 +++++--
 src/app/pages/cards/cards.page.ts             | 15 ++++++--
 .../pages/phones/items/items.component.html   |  2 +-
 src/app/services/api.service.ts               | 36 +++++++++----------
 src/app/services/local.service.ts             | 16 +++++----
 src/app/services/localPhones.service.ts       |  1 +
 src/app/services/new-service.service.ts       | 19 ++++++++++
 src/app/services/testing.service.spec.ts      | 16 ---------
 src/app/shared/Local.ts                       | 10 +++---
 src/assets/data/localPhones.json              |  8 +----
 16 files changed, 121 insertions(+), 81 deletions(-)
 create mode 100644 src/app/services/new-service.service.ts
 delete mode 100644 src/app/services/testing.service.spec.ts

diff --git a/src/app/app-routing.module.ts b/src/app/app-routing.module.ts
index b9e2d46..610efae 100644
--- a/src/app/app-routing.module.ts
+++ b/src/app/app-routing.module.ts
@@ -2,6 +2,8 @@ import { NgModule } from '@angular/core';
 import { PreloadAllModules, RouterModule, Routes } from '@angular/router';
 import { PhonesPageModule } from './pages/phones/phones.module';
 import { PhonesPageRoutingModule } from './pages/phones/phones-routing.module';
+import {CardsPageRoutingModule} from 'src/app/pages/cards/cards-routing.module';
+import {ProductComponent} from 'src/app/components/product/product.component';

 const routes: Routes = [
   {
@@ -29,6 +31,10 @@ const routes: Routes = [
     loadChildren: () =>
       import('./pages/cards/cards.module').then((m) => m.CardsPageModule),
   },
+  {
+    path: 'product/:id',
+    component: ProductComponent
+  },
   {
     path: 'phones',
     loadChildren: () =>
@@ -39,6 +45,7 @@ const routes: Routes = [
 @NgModule({
   imports: [
     RouterModule.forRoot(routes, { preloadingStrategy: PreloadAllModules }),
+    CardsPageRoutingModule
   ],
   exports: [RouterModule],
 })
diff --git a/src/app/app.module.ts b/src/app/app.module.ts
index 39606b4..0e5201c 100644
--- a/src/app/app.module.ts
+++ b/src/app/app.module.ts
@@ -11,11 +11,12 @@ import { AppComponent } from './app.component';
 import { AppRoutingModule } from './app-routing.module';
 import { PhonePipe } from './shared/pipes/phone.pipe';
 import {ApiService} from 'src/app/services/api.service';
+import {ProductComponent} from 'src/app/components/product/product.component';


 @NgModule({
-  declarations: [AppComponent, PhonePipe],
-  imports: [BrowserModule, IonicModule.forRoot(), AppRoutingModule, HttpClientModule, CommonModule],
+  declarations: [AppComponent, PhonePipe, ProductComponent],
+  imports: [BrowserModule, IonicModule.forRoot(), AppRoutingModule, HttpClientModule, CommonModule, FormsModule],
   providers: [{ provide: RouteReuseStrategy, useClass: IonicRouteStrategy }, ApiService],
   bootstrap: [AppComponent],
 })
diff --git a/src/app/components/product/product.component.html b/src/app/components/product/product.component.html
index 5c908e0..5f106cf 100644
--- a/src/app/components/product/product.component.html
+++ b/src/app/components/product/product.component.html
@@ -8,10 +8,23 @@
 <ion-content>
   <ion-grid>
     <ion-row>
-      <ion-col *ngFor="let product of products" size="6" size-lg="3" size-md="4">
-        <ion-card>
-          <ion-card-header>{{product.title}}</ion-card-header>
-        </ion-card>
+<!--      <ion-col *ngFor="let product of products" size="6" size-lg="3" size-md="4">-->
+<!--        <ion-card class="card" routerLink="product/{{product.id}}">-->
+<!--          <ion-card-header style="display: flex; justify-content: space-between">-->
+<!--            <ion-card-title class="card-title">{{product.title}}</ion-card-title>-->
+<!--            <ion-icon color="danger" name="heart-sharp"></ion-icon>-->
+<!--          </ion-card-header>-->
+<!--        </ion-card>-->
+<!--      </ion-col>-->
+<!--      [(ngModel)]="product" [routerLink]="['product/{{product.id}}']"-->
+      <ion-col  >
+        {{id}}
+        <div *ngIf="product">
+          <ion-card-title class="card-title">{{product[0].title}}</ion-card-title>
+          <ion-card-title class="card-title">{{product.title}}</ion-card-title>
+        </div>
+        <p>{{product[0].desc}}</p>
+        <p>{{product[0].price}}</p>
       </ion-col>
     </ion-row>
   </ion-grid>
diff --git a/src/app/components/product/product.component.ts b/src/app/components/product/product.component.ts
index 5cfd581..eb9594e 100644
--- a/src/app/components/product/product.component.ts
+++ b/src/app/components/product/product.component.ts
@@ -2,6 +2,9 @@ import {Component, OnInit} from '@angular/core';
 import {Route, Router, ActivatedRoute} from '@angular/router';
 import {ApiService} from 'src/app/services/api.service';
 import {Observable} from 'rxjs';
+import {LocalService} from 'src/app/services/local.service';
+import {LocalPhonesService} from 'src/app/services/localPhones.service';
+import {NewServiceService} from 'src/app/services/new-service.service';


 @Component({
@@ -11,24 +14,22 @@ export class ProductComponent implements OnInit {
   title = '';
   id = '';
   products: any = [];
-  product =[];
+  product: any = [];

-  constructor(private route: ActivatedRoute, private apiService: ApiService) {
+
+  constructor(private localService: LocalService, private route: ActivatedRoute,
+              private localPhoneService: LocalPhonesService, private newService: NewServiceService) {
   }

   ngOnInit() {
     this.id = this.route.snapshot.paramMap.get('id');
-    console.log(this.id);
-    // this.id = this.apiService.getProduct().subscribe(item=>item.title);
-    this.products = this.apiService.getProduct().subscribe(item =>{
-      console.log(item);
-      return item;
-    });
-    console.log(this.products);
-    // this.product = this.products.filter(item => {
-    //   // console.log(item.id === this.id);
-    //   return item;
+
+    // this.localService.getPhones().subscribe(items =>{
+    //   this.product = items.filter(x => x.id===this.id);
+    //   console.log(this.product);
     // });
+    // this.product = this.localPhoneService.phones.find(x => x.id===this.id);
+    this.product = this.newService.phones.find(x => x.id===this.id);
     console.log(this.product);
   }

diff --git a/src/app/pages/cards/cards-routing.module.ts b/src/app/pages/cards/cards-routing.module.ts
index dd4daea..72e5598 100644
--- a/src/app/pages/cards/cards-routing.module.ts
+++ b/src/app/pages/cards/cards-routing.module.ts
@@ -3,6 +3,7 @@ import { Routes, RouterModule } from '@angular/router';

 import { CardsPage } from './cards.page';
 import {ProductComponent} from 'src/app/components/product/product.component';
+import {HttpClientModule} from '@angular/common/http';

 const routes: Routes = [
   {
@@ -17,7 +18,7 @@ const routes: Routes = [
 ];

 @NgModule({
-  imports: [RouterModule.forChild(routes)],
+  imports: [RouterModule.forChild(routes), HttpClientModule],
   exports: [RouterModule],
 })
 export class CardsPageRoutingModule {}
diff --git a/src/app/pages/cards/cards.module.ts b/src/app/pages/cards/cards.module.ts
index 475295d..060f220 100644
--- a/src/app/pages/cards/cards.module.ts
+++ b/src/app/pages/cards/cards.module.ts
@@ -1,19 +1,21 @@
 import { NgModule } from '@angular/core';
 import { CommonModule } from '@angular/common';
 import { FormsModule } from '@angular/forms';
+import { BrowserModule } from '@angular/platform-browser';
+

 import { IonicModule } from '@ionic/angular';

 import { CardsPageRoutingModule } from './cards-routing.module';

 import { CardsPage } from './cards.page';
-
+// FIXME cardsPageRoutingModule
 @NgModule({
   imports: [
     CommonModule,
     FormsModule,
     IonicModule,
-    CardsPageRoutingModule
+    CardsPageRoutingModule,
   ],
   declarations: [CardsPage]
 })
diff --git a/src/app/pages/cards/cards.page.html b/src/app/pages/cards/cards.page.html
index 896f6b5..3607058 100644
--- a/src/app/pages/cards/cards.page.html
+++ b/src/app/pages/cards/cards.page.html
@@ -8,10 +8,16 @@
 <ion-content>
   <ion-grid>
     <ion-row>
+<!--      <ion-col *ngFor="let phone of phones">-->
+<!--        <ion-card>-->
+<!--          <ion-title>{{phone.title}}</ion-title>-->
+<!--        </ion-card>-->
+<!--      </ion-col>-->
       <ion-col *ngFor="let phone of phones" size="6" size-lg="3" size-md="4">
-        <ion-card class="card" routerLink="product/{{phone.id}}">
-          <!--          <img src="{{phone.main_img.link}}" />-->
-          <ion-img [src]="phone.main_img.link" class="card-img"></ion-img>
+        <ion-card class="card" >
+<!--          (click)="onSelect(phone.id)"-->
+          <ion-button routerLink="product/{{phone.id}}">{{phone.title}}</ion-button>
+<!--          <ion-img [src]="phone.main_img.link" class="card-img"></ion-img>-->
           <ion-card-header style="display: flex; justify-content: space-between">
             <ion-card-title class="card-title">{{phone.title}}</ion-card-title>
             <ion-icon color="danger" name="heart-sharp"></ion-icon>
diff --git a/src/app/pages/cards/cards.page.ts b/src/app/pages/cards/cards.page.ts
index 65e030c..83b34a8 100644
--- a/src/app/pages/cards/cards.page.ts
+++ b/src/app/pages/cards/cards.page.ts
@@ -1,5 +1,8 @@
 import { Component, OnInit } from '@angular/core';
 import {ApiService} from 'src/app/services/api.service';
+import {LocalPhonesService} from 'src/app/services/localPhones.service';
+import {LocalService} from 'src/app/services/local.service';
+import {ActivatedRoute, Router} from '@angular/router';



@@ -10,14 +13,20 @@ import {ApiService} from 'src/app/services/api.service';
 })
 export class CardsPage implements OnInit {
   // const {Filesystem} = Plugins;
- phones = [];
-  constructor(private apiPhones: ApiService) { }
+ phones: any = [];
+  constructor(private localService: LocalService, private router: Router, private route: ActivatedRoute) { }

   ngOnInit() {
-    this.apiPhones.getProduct().subscribe(items =>{
+    this.localService.getPhones().subscribe(items =>{
       this.phones = items;
     });
   }

+  onSelect(id){
+    this.router.navigate(['product', id],{relativeTo:this.route});
+    // this.router.navigate(['product', id],{relativeTo:this.route});
+    // this.router.navigateByUrl(`cards/product/${id}`);
+  }
+

 }
diff --git a/src/app/pages/phones/items/items.component.html b/src/app/pages/phones/items/items.component.html
index 486bcec..966b3e8 100644
--- a/src/app/pages/phones/items/items.component.html
+++ b/src/app/pages/phones/items/items.component.html
@@ -4,5 +4,5 @@

 <div>
   <h1>test</h1>
-   <p>{{product.tag}}</p>
+   <p>{{product}}</p>
 </div>
diff --git a/src/app/services/api.service.ts b/src/app/services/api.service.ts
index 3ddcd28..13bb66a 100644
--- a/src/app/services/api.service.ts
+++ b/src/app/services/api.service.ts
@@ -1,7 +1,7 @@
-import { Injectable } from '@angular/core';
-import { HttpClient } from '@angular/common/http';
-import { map } from 'rxjs/operators';
-import { Product } from 'src/app/shared/Product';
+import {Injectable} from '@angular/core';
+import {HttpClient} from '@angular/common/http';
+import {map} from 'rxjs/operators';
+import {Product} from 'src/app/shared/Product';

 @Injectable({
   providedIn: 'root',
@@ -10,34 +10,32 @@ export class ApiService {
   url = 'https://electronis-api.herokuapp.com/api/phones';
   urlAll = 'https://electronis-api.herokuapp.com/api/all';

-  constructor(private http: HttpClient) {}
+  constructor(private http: HttpClient) {
+  }

   async getInfo() {
     const data = await fetch(this.url);
     const res = await data.json();
     console.log(res);
   }
-
+
   getProduct() {
-    return this.http.get<Product>(this.url).pipe(
-      map((res: Product | any) => {
-        console.log(res);
-        return res;
-      })
-    );
+    return this.http.get<Product>(this.url).pipe(map((res: Product | any) => {
+      console.log(res);
+      return res;
+    }));
   }

   getAllProducts() {
     return this.http.get<any>(this.urlAll).pipe(map((res: any) => res));
   }
+
   getProductId(index: string) {
-    return this.http.get<Product>(this.url).pipe(
-      map((res: Product | any) => {
-        console.log(res);
-        res.filter((x) => x.id === index);
-        console.log(res);
-      })
-    );
+    return this.http.get<Product>(this.url).pipe(map((res: Product | any) => {
+      console.log(res);
+      res.filter((x) => x.id === index);
+      console.log(res);
+    }));
   }

   // async getProductId(index: string) {
diff --git a/src/app/services/local.service.ts b/src/app/services/local.service.ts
index d053108..3574ee9 100644
--- a/src/app/services/local.service.ts
+++ b/src/app/services/local.service.ts
@@ -1,5 +1,7 @@
-import { HttpClient } from '@angular/common/http';
-import { Injectable } from '@angular/core';
+import {HttpClient} from '@angular/common/http';
+import {Injectable} from '@angular/core';
+import {Local} from 'src/app/shared/Local';
+import {Observable} from 'rxjs';

 @Injectable({
   providedIn: 'root',
@@ -7,9 +9,11 @@ import { Injectable } from '@angular/core';

 export class LocalService {
   private url = '/assets/data/localPhones.json';
-  constructor(private http: HttpClient) {}
-  getPhones() {
-    return this.http.get(this.url)
+
+  constructor(private http: HttpClient) {
+  }
+
+  getPhones(): Observable<Local[]> {
+    return this.http.get<Local[]>(this.url);
   }
 }
-
\ No newline at end of file
diff --git a/src/app/services/localPhones.service.ts b/src/app/services/localPhones.service.ts
index fe58ed8..8c1f5f3 100644
--- a/src/app/services/localPhones.service.ts
+++ b/src/app/services/localPhones.service.ts
@@ -1,4 +1,5 @@
 export class LocalPhonesService {
+  // nu este injectable in root
   phones = [
     {
     id: 'phone-1', title: 'phone-1', price: 399
diff --git a/src/app/services/new-service.service.ts b/src/app/services/new-service.service.ts
new file mode 100644
index 0000000..99c4dea
--- /dev/null
+++ b/src/app/services/new-service.service.ts
@@ -0,0 +1,19 @@
+import { Injectable } from '@angular/core';
+
+@Injectable({
+  providedIn: 'root'
+})
+export class NewServiceService {
+  phones = [
+    {
+      id: 'phone-1', title: 'phone-1', price: 399
+    },
+    {
+      id: 'phone-2', title: 'phone-2', price: 299
+    },
+    {
+      id: 'phone-3', title: 'phone-4', price: 499
+    }
+  ];
+  constructor() { }
+}
diff --git a/src/app/services/testing.service.spec.ts b/src/app/services/testing.service.spec.ts
deleted file mode 100644
index ba76b09..0000000
--- a/src/app/services/testing.service.spec.ts
+++ /dev/null
@@ -1,16 +0,0 @@
-import { TestBed } from '@angular/core/testing';
-
-import { ProductService } from './testing.service';
-
-describe('ProductService', () => {
-  let service: ProductService;
-
-  beforeEach(() => {
-    TestBed.configureTestingModule({});
-    service = TestBed.inject(ProductService);
-  });
-
-  it('should be created', () => {
-    expect(service).toBeTruthy();
-  });
-});
diff --git a/src/app/shared/Local.ts b/src/app/shared/Local.ts
index f1893f2..4911e46 100644
--- a/src/app/shared/Local.ts
+++ b/src/app/shared/Local.ts
@@ -1,6 +1,6 @@
 export interface Local {
-    id: string;
-    title: string;
-    price: number;
-    desc: string;
- }
\ No newline at end of file
+  id: string;
+  title: string;
+  price: number;
+  desc: string;
+}
diff --git a/src/assets/data/localPhones.json b/src/assets/data/localPhones.json
index be09788..0e4a2e6 100644
--- a/src/assets/data/localPhones.json
+++ b/src/assets/data/localPhones.json
@@ -5,28 +5,22 @@
     "price": 199,
     "desc": "testing local"
   },
-
-
   {
     "id": "phone-2",
     "title": "iphone 2",
     "price": 299,
     "desc": "testing local"
   },
-
   {
     "id": "phone-3",
     "title": "iphone 3",
     "price": 399,
     "desc": "testing local"
   },
-
   {
     "id": "phone-4",
     "title": "iphone 4",
     "price": 499,
     "desc": "testing local"
-  },
-
-
+  }
 ]
--
2.37.1.windows.1

